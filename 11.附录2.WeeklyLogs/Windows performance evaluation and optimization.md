### Windows performance evaluation and optimization



对于旧设备和系统，由于硬件的老化和 Windows 7 停止更新，但这不影响用户还要继续使用它，相比之下其他更重要的因素在影响和左右用户的变更，如使用习惯、资金、软件等等的问题。本文旨在于此情况下优化电脑的系统、软件运行，以支持使用者能够勉强的流程处理工作。主要分为两部份：硬件升级、软件配置。



前提假设用户还需要继续或迫不得已继续使用以下配置的电脑：

> CUP : 2c2t、主频 2.0g（奔腾） 
>
> HDD : 500GB、转速 5400、缓存 32M
>
> RAM : 2G （ddr3 ）
>
> System : Windows 7 x86 or X64



#### 1. 方案

##### 1.1 性能评估

**基础硬件**

计算机基础的部分，不做重复阐述。

系统、软件的发展越是成熟和先进，基本上会集成更多“组件和需求”，比如代码、软件服务、CPU 线程、磁盘读取速度、子信息系统、自动修复等等。简而言之就是需要更多的计算机资源，有一部分不会向下兼容，导致在系统和应用层面上都被淘汰。一般的计算机生命周期在于其产品发布（硬件）后的 5 年内都是可以完成大部分的办公软件需求。

注意：请查看微软对 Windows 系统要求的硬件需求。

**估计计算机“运算”资源**

一个软件的运行（DISK-RAM-CPU-GPU）

CPU，线程、主频、制程、运算、指令等；

GPU，渲染、图形化计算、AI 计算等；

RAM，IO

DISK，IO

Note

计算该软件对硬件的需求的数值计算（CPU）、图形计算（GPU）、数据传输 IO（RAM、DISK、SATA、缓存等等），只要得知软件的上限瓶颈则可以补充和改进该设备的短板，以确保它的有效和流程的运行。



**借助软件工具**

1、对于 Windows 8、10 +

适用附录中的 [Windows 性能工具包](https://docs.microsoft.com/zh-cn/windows-hardware/test/wpt/)

2、winsat （Windows 7 计算机体验指数）

>运行检查：run Administrator W+R ：winsat formal
>
>查看结果#1：Control Panel\System and Security\System
>
>查看结果#2：Runs a set of pre-defined assessments and saves the data in an XML file in %systemroot%\performance\winsat\datastore.
>
>Windows 体验指数针对五个关键组件对计算机进行评级，并为每个组件提供一个分数以及总体基本分数。此基本分数仅与性能最差的组件子分数相当。基本分数的当前范围是从 1 到 7.9。<u>如果你的电脑评级低于 2 或 3，也许是时候考虑买一台新电脑了</u>，具体取决于你希望使用计算机执行何种任务。



##### 1.2 方案假设

1. 利用微软集成的工具对计算机进行计算机评估，也可以使用第三方工具，只要结果上符合基本的性能评估即可。

2. 寻找性能的短板：软件测试（单元测试、黑盒测试、白盒测试）或者说是 Debug 。

   单元，预估需要的工具、收集相关基础信息，对于所受的情况进行测试和评估，找到问题的所在（通常太花时间，一般情况下不建议使用）；

   黑盒，使用任何地条件对目标进行测试，无需注意或留意其执行过程中的成分，只关注输入和结果，排除干扰直接与问题对接，在总结与分析；

   白盒，在指定的条件下进行案例测试，建议安排 1~5 次以内（如果复杂且时长过高，建议缩短测试次数）进行测试，依据此进行总结和分析；

   PS：建议黑白盒测试，相互交接弥补测试中的缺陷，以便于快速找到问题和原因。软件测试一个学问，我只是拿来测试要测试的内容，学以致用，要用就学。

3. 信息收集与分析

   基于所收集的信息，如计算机的使用状态、用户的操作水平和使用需求、计算硬件资源信息、计算机的系统和软件信息等。（结合上下文信息）分析问题所在、补充短板、优化操作等。比如：打印 PDF 页数过多，内存资源不足，减少运行程序或升级硬件；视频解析 CPU 软件或硬解导致使用程度过高，添加硬解设备或更换 GPU 或置换电脑；显示器显示画面异常，检查数据传输硬件或检查计算机硬件；

4. 问题解决方案

   更加当下情况和以往情况，结合信息和解决方案，给与用户相关的操作或说明。并保证该问题的情况下能够修复或者除此以外能够保持流畅的运行，已维护用户的日常工作不受影响。

   不增加其负担、维持原有的工作习惯、引导或导向其进行正确的操作等等（有空再补充，其他条件根据实际情况进行调整和分配，毕竟这也算是一种“计算机资源管理”的方式）

5. None

   日后有空、遇到更加困难的时候再作补充、修正。	2020.08.17

   

##### 1.3 获得支持信息

如何补充有关性能需求和硬件基础信息？

> 1. 确认当前的硬件基础信息
> 2. 浏览有关硬件供应商信息
> 3. 浏览或咨询软件供应商的硬件需求信息
> 4. 利用互联网补充相关缺少的信息
> 5. 自行发挥（必须计算机软硬件知识和相关思考和实践）

如何获得额外的技术支援？

> 1. 供应商提供售后；
> 2. 供应商或第三方信息集成，如官方文档、书籍、第三方发解决方案等等信息途径（资金分类包含有偿和无偿服务）；
> 3. 网络社区、技术博客；
> 4. 行业前辈或同事；

PS：请合理有效的利用搜索引擎。



#### 2. 执行部分

划分为硬件升级和软件配置

硬件需要加装和软件调整、软件则是根据目前的使用版本做适当的配置和调整。

##### 2.1 硬件升级

注意：请留意本文的假设主机配置

**升级内存**

> 添加更多内存
> 这不是用于购买可加快计算机速度的硬件的指南。但对于任何关于如何使 Windows 更快运行的讨论，如果不提及你应该考虑向电脑添加更多随机存取内存 (RAM)，则它都是不完整的。
>
> 如果运行 Windows 7 的计算机看起来过于缓慢，这通常是因为电脑没有足够的 RAM。加快速度的最好方法是添加更多 RAM。
>
> Windows 7 可以在带有 1 GB RAM 的电脑上运行，但它在带有 2 GB 的电脑上运行得更快。若要获得最佳性能，<u>请将该内存量提升到 3 GB 或更高。</u>
>
> 提升内存量的另一个选项是使用 Windows‌ ReadyBoost。此功能允许你使用某些可移动媒体设备上的存储空间（如 U 盘）来加快计算机速度。相比打开电脑机箱并将内存模块插入其母板，将 U 盘插入 USB 端口更轻松。

Note

 Windows 10 建议采用 4~8G 的 DDR4 内存，Windows 7 建议采用 3~8G 的内存（可以是 DDR3 或 DDR4）



**跟换硬盘**

> <u>更换 SSD 硬盘可以避免频繁的执行以下操作，以获得更有效的系统运行效率</u>
>
> 1. 整理硬盘碎片
>    碎片会使硬盘执行额外的工作，这可能降低计算机性能。磁盘碎片整理程序会重新排列零散的数据，以便你的硬盘可以更高效地工作。磁盘碎片整理程序按计划运行，但你也可以手动整理硬盘碎片。
>
> 2. 清理硬盘
>    硬盘上不必要的文件会占用磁盘空间，并且可能会降低计算机速度。磁盘清理会删除临时文件、清空回收站并删除你不再需要的各种系统文件和其他项目。

Note

读写速度。从速度上 SSD 远远的快于 HDD ，也不会受到磁盘现有技术架构的限制，要么损坏不会想 HDD 那样运行变得缓慢。速度上的区别 HDD 在于 50~200M/s 之间，SSD 在于 300~1.5k/s。详细请查阅 HDD 的技术和 SSD 的技术发展。



**补充说明**

这里不会涉及 CPU 、GPU 等专业或大额的资金的核心设备，一般在购买时已确认，后期基本不会更改，一般也是而是整机更换。



##### 2.2 软件配置

一般的软件都自行调整一些细微的参数以提供相关的性能。就像一款游戏通过设置调整，高性能计算机基础可以获得更好、更快的全方位体验，低性能也减低“计算机资源基础”以获得流畅的体验。

###### 2.2.1 Microsoft Windows 7

参考 Microsoft 的相关方案：[优化 Windows 以提高性能](https://support.microsoft.com/zh-cn/help/15055/windows-7-optimize-windows-better-performance)

1、管理员执行部分

> 1. 整理硬盘碎片
>    碎片会使硬盘执行额外的工作，这可能降低计算机性能。磁盘碎片整理程序会重新排列零散的数据，以便你的硬盘可以更高效地工作。磁盘碎片整理程序按计划运行，但你也可以手动整理硬盘碎片。
>
> 2. 清理硬盘
>    硬盘上不必要的文件会占用磁盘空间，并且可能会降低计算机速度。磁盘清理会删除临时文件、清空回收站并删除你不再需要的各种系统文件和其他项目。
>
> 3. 关闭视觉效果
>    如果 Windows 运行缓慢，你可以通过禁用它的某些视觉效果来加快速度。它涉及到外观和性能的权衡。你希望 Windows 运行更快还是外观更好？ 如果你的电脑足够快，则你无需进行此权衡，但如果你的计算机性能勉强够运行 Windows 7，则缩减花哨的视觉效果可能很有用。
>
>    你可以逐个选择要关闭哪些视觉效果，或者可以让 Windows 为你选择。有 20 个可控制的视觉效果，如透明玻璃外观、菜单打开或关闭的方式以及是否显示阴影。
>
>    若要调整所有视觉效果以实现最佳性能：
>
>    打开“性能信息和工具”，方法是单击“开始”按钮 ，然后单击“控制面板”。在搜索框中，键入“性能信息和工具”，然后在结果列表中，单击“性能信息和工具”。
>    单击“调整视觉效果”需要管理员权限。 如果系统提示你输入管理员密码或进行确认，请键入该密码或进行确认。
>    单击“视觉效果”选项卡、单击“调整为最佳性能”，然后单击“确定”。（对于不太重要的选项，请选择“让 Windows 选择计算机的最佳设置”。）
>
> <u>更多信息请查阅附录的 [优化 Windows 以提高性能](https://support.microsoft.com/zh-cn/help/15055/windows-7-optimize-windows-better-performance)</u>

2、用户使用部分

控制运行有效的程序数量；

定时重启，每周内重启一次；



###### 2.2.2 Microsoft Office

仅适用于：打开文件的速度

**Excel**

Excel - 文件-选项-显示

> 1. 关闭「此应用程序启动时显示开始屏幕」
> 2. 关闭「禁用硬件加速」（Excel - 文件-选项-高级）

**Word**

Word - 文件-选项-高级 

> 1. 关闭「禁用硬件加速」
> 2. 关闭「使用子像素定位平滑屏幕上的字体」

**PowerPoint**

PowerPoint - 文件-选项-高级 

> 1. 关闭「禁用硬件加速」



###### 2.2.3 Other Software

Pending 待定



#### Appendix 

##### Element

计算机基础、CPU、RAM、磁盘等硬件和技术与当代软件运行性能需求；

基于以上就可以计算出该主机设备能否支持用户继续和流畅的工作环境；

##### Reference

1. Microsoft Docs

   [优化 Windows 以提高性能](https://support.microsoft.com/zh-cn/help/15055/windows-7-optimize-windows-better-performance)

   [Windows 性能工具包](https://docs.microsoft.com/zh-cn/windows-hardware/test/wpt/)

   [Windows 7 系统要求](https://support.microsoft.com/zh-cn/help/10737/windows-7-system-requirements)

   [查找 Windows 10 电脑规格和系统需求](https://www.microsoft.com/zh-cn/windows/windows-10-specifications)

   [Winsat -- windows command](https://docs.microsoft.com/en-us/previous-versions/windows/it-pro/windows-server-2012-r2-and-2012/cc770542(v=ws.11))

2. Blog

   [Win7 优化方案](http://blog.itpub.net/29732554/viewspace-2142709/)

   [使用 Windows 性能监视器收集数据](https://help.tableau.com/current/server/zh-cn/perf_collect_perfmon.htm)

3. [Windows 7 优化方法 集合#1](https://www.zhihu.com/question/27520624)

